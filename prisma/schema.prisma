datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  CUSTOMER
  ADMIN
  SUPERADMIN
}

enum BookingStatus {
  BOOKED
  DITERIMA
  DICUCI
  SIAP_DIAMBIL
  SELESAI
  DIBATALKAN
  EXPIRED
}

enum PaymentStatus {
  UNPAID
  PAID_CASH
}

enum VehicleType {
  MOBIL
  MOTOR
}

model User {
  id       Int    @id @default(autoincrement())
  email    String @unique
  username String @unique
  password String
  name     String
  phone    String @unique
  role     Role   @default(CUSTOMER)

  // Relasi
  vehicles Vehicle[]
  bookings Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Vehicle {
  id    Int         @id @default(autoincrement())
  plate String      @unique
  type  VehicleType
  model String?

  // Relasi
  owner   User @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  ownerId Int

  // Relasi
  bookings Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Service {
  id          Int     @id @default(autoincrement())
  name        String  @unique
  description String?
  price       Float

  bookings Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// model Location {
//   id      Int     @id @default(autoincrement())
//   name    String
//   address String
//   phone   String?

//   // Relasi
//   bookings Booking[]

//   createdAt DateTime @default(now())
//   updatedAt DateTime @updatedAt
// }

model Booking {
  id          Int           @id @default(autoincrement())
  bookingDate DateTime
  totalPrice  Float
  status      BookingStatus @default(BOOKED)
  notes       String?

  paymentStatus PaymentStatus @default(UNPAID)

  cancellationReason String?
  cancelledAt        DateTime?

  // Relasi
  user   User @relation(fields: [userId], references: [id])
  userId Int

  vehicle   Vehicle @relation(fields: [vehicleId], references: [id])
  vehicleId Int

  // location   Location @relation(fields: [locationId], references: [id])
  // locationId Int

  services Service[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([status])
  // @@index([locationId])
  @@index([bookingDate])
}
